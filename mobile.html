<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <style>
    .viewer-frame{width:100%;height:520px;border-radius:22px;overflow:hidden;}
    model-viewer{width:100%;height:100%;}
  </style>
</head>

<body>
  <div class="viewer-frame">
    <model-viewer
      id="bottle3d"
      src="growthbottle.glb"
      camera-controls
      auto-rotate
      environment-image="neutral"
      exposure="1"
      shadow-intensity="1.2">
    </model-viewer>
  </div>

  <script>
    (async () => {
      // 1) attendre que <model-viewer> soit prêt
      await customElements.whenDefined('model-viewer');

      const viewer = document.getElementById('bottle3d');

      function applyResponsiveCamera() {
        const isMobile = window.matchMedia('(max-width: 768px)').matches;

        // IMPORTANT: si tu as des min/max-camera-orbit trop serrés,
        // la caméra ne bougera pas -> on les élargit.
        viewer.setAttribute('min-camera-orbit', 'auto auto 2.2m');
        viewer.setAttribute('max-camera-orbit', 'auto auto 4.5m');

        viewer.setAttribute('camera-orbit', isMobile
          ? '0deg 75deg 3.8m'   // mobile = plus loin => bouteille plus petite
          : '0deg 75deg 2.8m'   // desktop
        );

        // Debug: vérifie que l'attribut change bien
        console.log('camera-orbit =', viewer.getAttribute('camera-orbit'));
      }

      applyResponsiveCamera();
      window.addEventListener('resize', applyResponsiveCamera);
    })();
  </script>
</body>
</html>
